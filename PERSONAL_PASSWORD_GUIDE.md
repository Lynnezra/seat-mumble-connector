# Mumble ä¸ªäººå¯†ç è®¤è¯ç³»ç»ŸæŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

è¿™ä¸ªç³»ç»Ÿå…è®¸ç”¨æˆ·ä½¿ç”¨ä¸ªäººå¯†ç ç™»å½• Mumble æœåŠ¡å™¨ï¼Œè€Œä¸éœ€è¦çŸ¥é“æœåŠ¡å™¨å¯†ç ã€‚ç”¨æˆ·ä½¿ç”¨ä¸ªäººå¯†ç ç™»å½•åä¼šè‡ªåŠ¨è·å¾—è®¤è¯æƒé™ã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- **ä¸ªäººå¯†ç ç™»å½•** - æ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å¯†ç 
- **è‡ªåŠ¨è®¤è¯æƒé™** - ä½¿ç”¨ä¸ªäººå¯†ç ç™»å½•åè‡ªåŠ¨è·å¾— auth çŠ¶æ€
- **æœåŠ¡å™¨å¯†ç ä»ç„¶æœ‰æ•ˆ** - ç®¡ç†å‘˜ä»å¯ä½¿ç”¨æœåŠ¡å™¨å¯†ç 
- **åŒé‡è®¤è¯æ”¯æŒ** - æ”¯æŒä¸ªäººå¯†ç å’ŒæœåŠ¡å™¨å¯†ç ä¸¤ç§æ–¹å¼
- **çµæ´»é…ç½®** - å¯ä»¥å¯ç”¨/ç¦ç”¨ä¸ªäººå¯†ç è®¤è¯åŠŸèƒ½

## ğŸ”§ é…ç½®è®¾ç½®

### 1. å¯ç”¨ä¸ªäººå¯†ç è®¤è¯

åœ¨ SeAT ç®¡ç†ç•Œé¢ä¸­ï¼š

1. è®¿é—® **Connector â†’ Settings**
2. æ‰¾åˆ° Mumble é©±åŠ¨è®¾ç½®
3. å‹¾é€‰ **"å¯ç”¨ä¸ªäººå¯†ç è®¤è¯"** (Enable personal password authentication)
4. å¯é€‰ï¼šè®¾ç½® **"æœåŠ¡å™¨å¯†ç "** ä½œä¸ºå¤‡ç”¨è®¤è¯æ–¹å¼
5. ä¿å­˜è®¾ç½®

### 2. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
php artisan migrate
```

## ğŸ‘¥ ç”¨æˆ·å¯†ç ç®¡ç†

### è®¾ç½®ç”¨æˆ·å¯†ç 

```bash
# äº¤äº’å¼è®¾ç½®å¯†ç 
php artisan seat-mumble-connector:manage-passwords set

# ç›´æ¥æŒ‡å®šå‚æ•°
php artisan seat-mumble-connector:manage-passwords set --username=JohnDoe --password=mypassword123 --seat-user-id=42
```

### æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·

```bash
php artisan seat-mumble-connector:manage-passwords list
```

### ç§»é™¤ç”¨æˆ·å¯†ç 

```bash
# äº¤äº’å¼ç§»é™¤
php artisan seat-mumble-connector:manage-passwords remove

# ç›´æ¥æŒ‡å®šç”¨æˆ·å
php artisan seat-mumble-connector:manage-passwords remove --username=JohnDoe
```

### æµ‹è¯•ç”¨æˆ·è®¤è¯

```bash
# æµ‹è¯•ç‰¹å®šç”¨æˆ·çš„å¯†ç 
php artisan seat-mumble-connector:manage-passwords test --username=JohnDoe --password=mypassword123
```

## ğŸ” è®¤è¯æµç¨‹

### ç”¨æˆ·ç™»å½•è¿‡ç¨‹

1. **ç”¨æˆ·è¾“å…¥å¯†ç **
   - åœ¨ Mumble å®¢æˆ·ç«¯ä¸­è¾“å…¥ä¸ªäººå¯†ç 
   
2. **ç³»ç»ŸéªŒè¯å¯†ç **
   - é¦–å…ˆæ£€æŸ¥æ˜¯å¦ä¸ºæœåŠ¡å™¨å¯†ç 
   - ç„¶åæ£€æŸ¥æ˜¯å¦ä¸ºä¸ªäººå¯†ç 
   
3. **è‡ªåŠ¨æƒé™åˆ†é…**
   - å¦‚æœæ˜¯ä¸ªäººå¯†ç ï¼šè‡ªåŠ¨è®¾ç½®ä¸ºå·²è®¤è¯çŠ¶æ€
   - å¦‚æœæ˜¯æœåŠ¡å™¨å¯†ç ï¼šæŒ‰æ ‡å‡†æµç¨‹å¤„ç†

### è®¤è¯ç±»å‹

- **æœåŠ¡å™¨å¯†ç ** (`server_password`) - ä¼ ç»Ÿçš„æœåŠ¡å™¨å¯†ç è®¤è¯
- **ä¸ªäººå¯†ç ** (`personal_password`) - æ–°çš„ä¸ªäººå¯†ç è®¤è¯ï¼Œè‡ªåŠ¨è·å¾— auth æƒé™
- **é”™è¯¯** (`error`) - è®¤è¯è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯

## ğŸ® ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æ™®é€šç”¨æˆ·ç™»å½•

1. ç”¨æˆ·åœ¨ Mumble å®¢æˆ·ç«¯ä¸­è¿æ¥æœåŠ¡å™¨
2. è¾“å…¥è‡ªå·±çš„ä¸ªäººå¯†ç 
3. ç³»ç»Ÿè‡ªåŠ¨éªŒè¯å¹¶æˆäºˆè®¤è¯æƒé™
4. ç”¨æˆ·å¯ä»¥æ­£å¸¸ä½¿ç”¨è¯­éŸ³åŠŸèƒ½

### åœºæ™¯2: ç®¡ç†å‘˜ç™»å½•

1. ç®¡ç†å‘˜å¯ä»¥ä½¿ç”¨æœåŠ¡å™¨å¯†ç ç™»å½•
2. ä¹Ÿå¯ä»¥è®¾ç½®ä¸ªäººå¯†ç ä½¿ç”¨ä¸ªäººå¯†ç ç™»å½•
3. ä¸¤ç§æ–¹å¼éƒ½æœ‰æ•ˆ

### åœºæ™¯3: æ‰¹é‡ç”¨æˆ·ç®¡ç†

```bash
# ä¸ºæ‰€æœ‰å·²æ³¨å†Œçš„ Mumble ç”¨æˆ·è®¾ç½®é»˜è®¤å¯†ç 
# æ³¨æ„ï¼šå®é™…ä½¿ç”¨ä¸­åº”è¯¥è®©ç”¨æˆ·è‡ªå·±è®¾ç½®å¯†ç 

# æŸ¥çœ‹å½“å‰ç”¨æˆ·
php artisan seat-mumble-connector:manage-passwords list

# ä¸ºç‰¹å®šç”¨æˆ·è®¾ç½®å¯†ç 
php artisan seat-mumble-connector:manage-passwords set --username=User1 --password=temppass123 --seat-user-id=1
```

## ğŸ”§ ç®¡ç†å‘˜æ“ä½œ

### æŸ¥çœ‹è®¤è¯æ—¥å¿—

ç³»ç»Ÿä¼šè®°å½•æ‰€æœ‰è®¤è¯å°è¯•ï¼Œå¯ä»¥åœ¨ Laravel æ—¥å¿—ä¸­æŸ¥çœ‹ï¼š

```bash
tail -f storage/logs/laravel.log | grep "Authentication"
```

### é‡ç½®ç”¨æˆ·å¯†ç 

```bash
# ç§»é™¤æ—§å¯†ç 
php artisan seat-mumble-connector:manage-passwords remove --username=JohnDoe

# è®¾ç½®æ–°å¯†ç 
php artisan seat-mumble-connector:manage-passwords set --username=JohnDoe --password=newpassword123 --seat-user-id=42
```

### ç¦ç”¨ä¸ªäººå¯†ç è®¤è¯

å¦‚æœéœ€è¦æš‚æ—¶ç¦ç”¨ä¸ªäººå¯†ç è®¤è¯ï¼š

1. è®¿é—® Connector â†’ Settings
2. å–æ¶ˆå‹¾é€‰ **"å¯ç”¨ä¸ªäººå¯†ç è®¤è¯"**
3. ä¿å­˜è®¾ç½®

ç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°æ ‡å‡†çš„æœåŠ¡å™¨å¯†ç è®¤è¯æ¨¡å¼ã€‚

## ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

### å¯†ç å®‰å…¨

- ç”¨æˆ·å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨
- å»ºè®®ç”¨æˆ·ä½¿ç”¨å¼ºå¯†ç 
- æ”¯æŒå¯†ç å®šæœŸæ›´æ¢

### æœåŠ¡å™¨å®‰å…¨

- æœåŠ¡å™¨å¯†ç ä»ç„¶æœ‰æ•ˆï¼Œä½œä¸ºå¤‡ç”¨è®¤è¯æ–¹å¼
- Ice æ¥å£é€šä¿¡åŠ å¯†
- è®¤è¯æ—¥å¿—è®°å½•æ‰€æœ‰å°è¯•

### æƒé™æ§åˆ¶

- ä¸ªäººå¯†ç ç™»å½•è‡ªåŠ¨è·å¾—åŸºæœ¬è®¤è¯æƒé™
- é¢‘é“æƒé™ä»é€šè¿‡ Access Management æ§åˆ¶
- ç®¡ç†å‘˜æƒé™ç‹¬ç«‹ç®¡ç†

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1: ç”¨æˆ·æ— æ³•ä½¿ç”¨ä¸ªäººå¯†ç ç™»å½•

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥åŠŸèƒ½æ˜¯å¦å¯ç”¨
# åœ¨ Connector â†’ Settings ä¸­ç¡®è®¤ "å¯ç”¨ä¸ªäººå¯†ç è®¤è¯" å·²å‹¾é€‰

# æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è®¾ç½®å¯†ç 
php artisan seat-mumble-connector:manage-passwords list

# æµ‹è¯•å¯†ç 
php artisan seat-mumble-connector:manage-passwords test --username=ç”¨æˆ·å --password=å¯†ç 
```

### é—®é¢˜2: è®¤è¯åæ²¡æœ‰è·å¾—æƒé™

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ Ice è¿æ¥
php artisan seat-mumble-connector:test-ice-connection

# æ£€æŸ¥ç”¨æˆ·æƒé™
php artisan seat-mumble-connector:test-access-management --user-id=ç”¨æˆ·ID
```

### é—®é¢˜3: æ•°æ®åº“é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# è¿è¡Œæ•°æ®åº“è¿ç§»
php artisan migrate

# æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
# åº”è¯¥æœ‰ mumble_user_auth è¡¨
```

## ğŸ“Š æ•°æ®åº“ç»“æ„

### mumble_user_auth è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | bigint | ä¸»é”® |
| seat_user_id | bigint | SeAT ç”¨æˆ·ID |
| mumble_username | varchar(64) | Mumble ç”¨æˆ·å |
| password_hash | varchar(255) | å¯†ç å“ˆå¸Œ |
| enabled | boolean | æ˜¯å¦å¯ç”¨ |
| auth_status | enum | è®¤è¯çŠ¶æ€ |
| last_login | timestamp | æœ€åç™»å½•æ—¶é—´ |
| notes | text | å¤‡æ³¨ |

## ğŸ‰ å®Œæˆï¼

é€šè¿‡è¿™ä¸ªç³»ç»Ÿï¼Œæ‚¨çš„ç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š

1. âœ… ä½¿ç”¨ä¸ªäººå¯†ç ç™»å½• Mumble
2. âœ… è‡ªåŠ¨è·å¾—è®¤è¯æƒé™
3. âœ… ä¸éœ€è¦çŸ¥é“æœåŠ¡å™¨å¯†ç 
4. âœ… äº«å—å®‰å…¨ä¸”ä¾¿æ·çš„è¯­éŸ³é€šä¿¡ä½“éªŒ

æœåŠ¡å™¨å¯†ç ä»ç„¶å­˜åœ¨å¹¶æœ‰æ•ˆï¼Œä¸ºç®¡ç†å‘˜æä¾›äº†å¤‡ç”¨è®¿é—®æ–¹å¼ã€‚è¿™æ ·æ—¢ä¿è¯äº†å®‰å…¨æ€§ï¼Œåˆæå‡äº†ç”¨æˆ·ä½“éªŒï¼